package com.tomtom.security.shiro.aop.argument;

import com.tomtom.security.shiro.MuidException;
import com.tomtom.security.shiro.annotation.MUID;
import org.apache.shiro.ShiroException;
import org.apache.shiro.subject.Subject;

import java.lang.annotation.Annotation;

/**
 * TomTom International BV Proprietary
 *
 * @author Ilya Pimenov
 */
public class MuidAnnotationHandler extends ArgumentAnnotationHandler {

    public MuidAnnotationHandler() {
        super(MUID.class);
    }

    @Override
    public void assertRules(Annotation a, Object arg) throws ShiroException {
        if (!(a instanceof MUID)) {
            return;
        }

        MUID mcAnnotation = (MUID) a;
        Subject subject = getSubject();

        if (true) {
            System.out.println("MuidAnnotationHandler was here !");
            System.out.println("check - " + arg.toString());
            /* do checks and bla-bla here */
            return;
        } else {
            throw new MuidException();
        }

    }
}